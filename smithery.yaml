# Smithery configuration file

# Build configuration
build:
  # Install Python dependencies
  command: |
    cd backend && \
    pip install -r requirements.txt

# Run configuration
run:
  # Command to start the FastAPI application
  command: uvicorn app.main:app --host 0.0.0.0 --port $PORT

# Environment variables
env:
  # Required environment variables (set these in Smithery dashboard)
  - GITHUB_APP_ID
  - GITHUB_APP_PRIVATE_KEY
  - GITHUB_WEBHOOK_SECRET
  - SLACK_BOT_TOKEN
  - SLACK_SIGNING_SECRET
  - DATABASE_URL
  - SECRET_KEY

# Build environment
build_environment:
  python: "3.9"

# Deployment settings
deploy:
  auto_deploy: true
  branch: main

# Health check
health_check:
  path: /health
  timeout: 30
  interval: 60

# Build caching
cache:
  - ~/.cache/pip
  - /opt/buildhome/.cache/pip

# Security headers
headers:
  - for: /*
    values:
      X-Frame-Options: DENY
      X-Content-Type-Options: nosniff
      X-XSS-Protection: "1; mode=block"
      Referrer-Policy: same-origin
      Content-Security-Policy: "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self' data:;"

# Redirects
redirects:
  - from: /*
    to: /
    status: 200
    force: true
